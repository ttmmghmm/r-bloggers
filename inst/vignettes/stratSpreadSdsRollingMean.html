<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="http://article.gmane.org/gmane.comp.lang.r.finance/12931" />

<meta name="date" content="2014-12-11" />

<title>Pairs trading strategy using a spread from Financial Instrument package</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css,body%20%7B%0A%20%20background%2Dcolor%3A%20%23fff%3B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20max%2Dwidth%3A%20700px%3B%0A%20%20overflow%3A%20visible%3B%0A%20%20padding%2Dleft%3A%202em%3B%0A%20%20padding%2Dright%3A%202em%3B%0A%20%20font%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0A%20%20font%2Dsize%3A%2014px%3B%0A%20%20line%2Dheight%3A%201%2E35%3B%0A%7D%0A%0A%23header%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0A%0A%23TOC%20%7B%0A%20%20clear%3A%20both%3B%0A%20%20margin%3A%200%200%2010px%2010px%3B%0A%20%20padding%3A%204px%3B%0A%20%20width%3A%20400px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20border%2Dradius%3A%205px%3B%0A%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20font%2Dsize%3A%2013px%3B%0A%20%20line%2Dheight%3A%201%2E3%3B%0A%7D%0A%20%20%23TOC%20%2Etoctitle%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%20%20font%2Dsize%3A%2015px%3B%0A%20%20%20%20margin%2Dleft%3A%205px%3B%0A%20%20%7D%0A%0A%20%20%23TOC%20ul%20%7B%0A%20%20%20%20padding%2Dleft%3A%2040px%3B%0A%20%20%20%20margin%2Dleft%3A%20%2D1%2E5em%3B%0A%20%20%20%20margin%2Dtop%3A%205px%3B%0A%20%20%20%20margin%2Dbottom%3A%205px%3B%0A%20%20%7D%0A%20%20%23TOC%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dleft%3A%20%2D2em%3B%0A%20%20%7D%0A%20%20%23TOC%20li%20%7B%0A%20%20%20%20line%2Dheight%3A%2016px%3B%0A%20%20%7D%0A%0Atable%20%7B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dcolor%3A%20%23DDDDDD%3B%0A%20%20border%2Dstyle%3A%20outset%3B%0A%20%20border%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0A%20%20border%2Dwidth%3A%202px%3B%0A%20%20padding%3A%205px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%20%20line%2Dheight%3A%2018px%3B%0A%20%20padding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0A%20%20border%2Dleft%2Dstyle%3A%20none%3B%0A%20%20border%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Ap%20%7B%0A%20%20margin%3A%200%2E5em%200%3B%0A%7D%0A%0Ablockquote%20%7B%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20padding%3A%200%2E25em%200%2E75em%3B%0A%7D%0A%0Ahr%20%7B%0A%20%20border%2Dstyle%3A%20solid%3B%0A%20%20border%3A%20none%3B%0A%20%20border%2Dtop%3A%201px%20solid%20%23777%3B%0A%20%20margin%3A%2028px%200%3B%0A%7D%0A%0Adl%20%7B%0A%20%20margin%2Dleft%3A%200%3B%0A%7D%0A%20%20dl%20dd%20%7B%0A%20%20%20%20margin%2Dbottom%3A%2013px%3B%0A%20%20%20%20margin%2Dleft%3A%2013px%3B%0A%20%20%7D%0A%20%20dl%20dt%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%7D%0A%0Aul%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%7D%0A%20%20ul%20li%20%7B%0A%20%20%20%20list%2Dstyle%3A%20circle%20outside%3B%0A%20%20%7D%0A%20%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dbottom%3A%200%3B%0A%20%20%7D%0A%0Apre%2C%20code%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20color%3A%20%23333%3B%0A%7D%0Apre%20%7B%0A%20%20white%2Dspace%3A%20pre%2Dwrap%3B%20%20%20%20%2F%2A%20Wrap%20long%20lines%20%2A%2F%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20margin%3A%205px%200px%2010px%200px%3B%0A%20%20padding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Acode%20%7B%0A%20%20font%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0A%20%20font%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0A%20%20padding%3A%202px%200px%3B%0A%7D%0A%0Adiv%2Efigure%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0A%20%20background%2Dcolor%3A%20%23FFFFFF%3B%0A%20%20padding%3A%202px%3B%0A%20%20border%3A%201px%20solid%20%23DDDDDD%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20margin%3A%200%205px%3B%0A%7D%0A%0Ah1%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%20%20font%2Dsize%3A%2035px%3B%0A%20%20line%2Dheight%3A%2040px%3B%0A%7D%0A%0Ah2%20%7B%0A%20%20border%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20padding%2Dbottom%3A%202px%3B%0A%20%20font%2Dsize%3A%20145%25%3B%0A%7D%0A%0Ah3%20%7B%0A%20%20border%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20font%2Dsize%3A%20120%25%3B%0A%7D%0A%0Ah4%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0A%20%20margin%2Dleft%3A%208px%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Ah5%2C%20h6%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23ccc%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Aa%20%7B%0A%20%20color%3A%20%230033dd%3B%0A%20%20text%2Ddecoration%3A%20none%3B%0A%7D%0A%20%20a%3Ahover%20%7B%0A%20%20%20%20color%3A%20%236666ff%3B%20%7D%0A%20%20a%3Avisited%20%7B%0A%20%20%20%20color%3A%20%23800080%3B%20%7D%0A%20%20a%3Avisited%3Ahover%20%7B%0A%20%20%20%20color%3A%20%23BB00BB%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%0A%2F%2A%20Class%20described%20in%20https%3A%2F%2Fbenjeffrey%2Ecom%2Fposts%2Fpandoc%2Dsyntax%2Dhighlighting%2Dcss%0A%20%20%20Colours%20from%20https%3A%2F%2Fgist%2Egithub%2Ecom%2Frobsimmons%2F1172277%20%2A%2F%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Keyword%20%2A%2F%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%2F%2A%20DataType%20%2A%2F%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%2F%2A%20DecVal%20%28decimal%20values%29%20%2A%2F%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20BaseN%20%2A%2F%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Float%20%2A%2F%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Char%20%2A%2F%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20String%20%2A%2F%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%2F%2A%20Comment%20%2A%2F%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%2F%2A%20OtherToken%20%2A%2F%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20AlertToken%20%2A%2F%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Function%20calls%20%2A%2F%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%2F%2A%20ErrorTok%20%2A%2F%0A%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">Pairs trading strategy using a spread from Financial Instrument package</h1>
<h4 class="author"><em><a href="http://article.gmane.org/gmane.comp.lang.r.finance/12931">http://article.gmane.org/gmane.comp.lang.r.finance/12931</a></em></h4>
<h4 class="date"><em>2014-12-11</em></h4>
</div>


<p>Based on a Notional Spread and Standard Devations from the rolling mean * Create a pairs trading strategy using a spread from Financial Instrument package.</p>
<p><code>{boilerplate, r} require(quantstrat) require(Quandl) require(quantmod)</code></p>
<div id="data-prep" class="section level2">
<h2>Data Prep</h2>
<div id="get-data-from-quandl" class="section level3">
<h3>get data from Quandl</h3>
<p><code>{get data from Quandl, r} symb1 &lt;- Quandl(&quot;CHRIS/CME_ES1&quot;, type = &quot;xts&quot;, trim_start=&quot;2010-01-01&quot;, trim_end=&quot;2014-11-17&quot;) symb2 &lt;- Quandl(&quot;CHRIS/CME_YM1&quot;, type = &quot;xts&quot;, trim_start=&quot;2010-01-01&quot;, trim_end=&quot;2014-11-17&quot;)</code> Trim and Format - Using settlement as Close value ```{Trim and Format - Using settlement as Close value, r} symb1 &lt;- symb1[,c(1,2,3,6)] symb2 &lt;- symb2[,c(1,2,3,6)]</p>
<p>colnames(symb1) &lt;- c(“Open”, “High”, “Low”, “Close”) colnames(symb2) &lt;- c(“Open”, “High”, “Low”, “Close”)</p>
</div>
</div>
<div id="clean-data-so-only-dates-where-both-trades-exist-merge---cbindsymb1-symb2" class="section level1">
<h1>Clean data so only dates where both trades exist merge &lt;- cbind(symb1, symb2)</h1>
<p>dates &lt;- index(merge[complete.cases(merge),]) symb1&lt;- symb1[dates] symb2&lt;- symb2[dates]</p>
</div>
<div id="strategy-" class="section level1">
<h1>———————–STRATEGY——————-</h1>
<p>```</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># -----------------------STRATEGY-------------------</span>
<span class="co">#clean variables for reruns</span>
<span class="kw">suppressWarnings</span>(<span class="kw">rm</span>(<span class="st">&quot;order_book.bbands&quot;</span>,<span class="dt">pos=</span>.strategy))
<span class="kw">suppressWarnings</span>(<span class="kw">rm</span>(<span class="st">&quot;account.bbands&quot;</span>,<span class="st">&quot;portfolio.bbands&quot;</span>,<span class="dt">pos=</span>.blotter))
<span class="kw">suppressWarnings</span>(<span class="kw">rm</span>(<span class="st">&quot;account.st&quot;</span>,<span class="st">&quot;portfolio.st&quot;</span>,<span class="st">&quot;stock.str&quot;</span>,<span class="st">&quot;stratBBands&quot;</span>,<span class="st">&quot;initDate&quot;</span>,<span class="st">&quot;initEq&quot;</span>,<span class="st">'start_t'</span>,<span class="st">'end_t'</span>))

<span class="co">#Initial values / parameters</span>
initDate=<span class="st"> </span><span class="kw">index</span>(symb1)[<span class="dv">1</span>]-<span class="dv">1</span>
initEq=<span class="dv">100000</span>

SD =<span class="st"> </span><span class="dv">2</span> <span class="co"># how many standard deviations</span>
N =<span class="st"> </span><span class="dv">20</span> <span class="co"># length of moving average</span>

<span class="co">#Initialize FinancialInstrument Objects</span>

<span class="kw">currency</span>(<span class="st">'USD'</span>)

<span class="kw">future</span>( <span class="dt">primary_id =</span> <span class="st">&quot;symb1&quot;</span>,
        <span class="dt">currency =</span> <span class="st">&quot;USD&quot;</span>,
        <span class="dt">tick_size =</span> .<span class="dv">25</span>,
        <span class="dt">multiplier =</span> <span class="dv">50</span>)

<span class="kw">future</span>( <span class="dt">primary_id =</span> <span class="st">&quot;symb2&quot;</span>,
        <span class="dt">currency =</span> <span class="st">&quot;USD&quot;</span>,
        <span class="dt">tick_size =</span> <span class="dv">1</span>,
        <span class="dt">multiplier =</span> <span class="dv">5</span>)

<span class="co">#Create Spread Series</span>
calcRatio &lt;-<span class="st"> </span>function(x) {
  <span class="co">#returns the ratio of notional close prices for 2 symbols</span>
  x1 &lt;-<span class="st"> </span><span class="kw">get</span>(x[<span class="dv">1</span>])
  x2 &lt;-<span class="st"> </span><span class="kw">get</span>(x[<span class="dv">2</span>])
  mult1 &lt;-<span class="st"> </span><span class="kw">getInstrument</span>(x[<span class="dv">1</span>])$multiplier
  mult2 &lt;-<span class="st"> </span><span class="kw">getInstrument</span>(x[<span class="dv">2</span>])$multiplier
  rat.Op &lt;-<span class="st"> </span>((mult1 *<span class="st"> </span><span class="kw">Op</span>(x1))) /<span class="st"> </span>(mult2 *<span class="st"> </span><span class="kw">Op</span>(x2))
  rat.Hi &lt;-<span class="st"> </span>((mult1 *<span class="st"> </span><span class="kw">Hi</span>(x1))) /<span class="st"> </span>(mult2 *<span class="st"> </span><span class="kw">Hi</span>(x2))
  rat.Lo &lt;-<span class="st"> </span>((mult1 *<span class="st"> </span><span class="kw">Lo</span>(x1))) /<span class="st"> </span>(mult2 *<span class="st"> </span><span class="kw">Lo</span>(x2))
  rat.Cl &lt;-<span class="st"> </span>((mult1 *<span class="st"> </span><span class="kw">Cl</span>(x1))) /<span class="st"> </span>(mult2 *<span class="st"> </span><span class="kw">Cl</span>(x2))
  ratio &lt;-<span class="st"> </span><span class="kw">cbind</span>(rat.Op, rat.Hi, rat.Lo, rat.Cl)
  <span class="kw">colnames</span>(ratio) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Open&quot;</span>, <span class="st">&quot;High&quot;</span>, <span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Close&quot;</span>)
  <span class="kw">return</span>(ratio)
}

Ratio &lt;-<span class="st"> </span><span class="kw">calcRatio</span>(<span class="kw">c</span>(<span class="st">&quot;symb1&quot;</span>, <span class="st">&quot;symb2&quot;</span>))

<span class="co">#Initialize Spread (using notional ratio as hedge ratio) spread(primary_id = &quot;symb1.symb2&quot;,</span>
       currency =<span class="st"> &quot;USD&quot;</span>,
       members =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;symb1&quot;</span>, <span class="st">&quot;symb2&quot;</span>),
       memberratio =<span class="st"> </span><span class="kw">list</span>(<span class="dv">1</span>, <span class="kw">as.numeric</span>(-<span class="kw">Cl</span>(Ratio))) <span class="er">)</span>

<span class="co">#Notional Ratio is also spread for trading</span>
symb1.symb2 &lt;-<span class="st"> </span>Ratio

<span class="co">#name strings</span>
portfolio.st =<span class="st"> 'bbands'</span>
account.st =<span class="st"> 'bbands'</span>

<span class="co">#initialization of strategy objects ---- initPortf(portfolio.st, #portfolio Initiatlization</span>
          symbols =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;symb1.symb2&quot;</span>, <span class="st">&quot;symb1&quot;</span>, <span class="st">&quot;symb2&quot;</span>),
          initDate =<span class="st"> </span>initDate,
          currency =<span class="st"> &quot;USD&quot;</span>,
          initPosQty =<span class="st"> </span><span class="dv">0</span><span class="er">)</span>

<span class="kw">initAcct</span>(account.st, <span class="co">#account initialization</span>
         <span class="dt">portfolios =</span> portfolio.st,
         <span class="dt">initDate =</span> initDate,
         <span class="dt">initEq =</span> initEq)

<span class="kw">initOrders</span>(<span class="dt">portfolio =</span> portfolio.st, <span class="co">#orders initialize</span>
           <span class="dt">initDate =</span> initDate)

<span class="kw">addPosLimit</span>( <span class="dt">portfolio =</span> portfolio.st, <span class="co"># add position limit rules</span>
             <span class="dt">symbol =</span> <span class="st">'symb1.symb2'</span>,
             <span class="dt">timestamp =</span> initDate,
             <span class="dt">maxpos =</span> <span class="dv">1</span>,
             <span class="dt">longlevels =</span> <span class="dv">1</span>,
             <span class="dt">minpos =</span> -<span class="dv">1</span>)

<span class="kw">addPosLimit</span>( <span class="dt">portfolio =</span> portfolio.st, <span class="co"># add position limit rules</span>
             <span class="dt">symbol =</span> <span class="st">'symb1'</span>,
             <span class="dt">timestamp =</span> initDate,
             <span class="dt">maxpos =</span> <span class="dv">2</span>,
             <span class="dt">longlevels =</span> <span class="dv">1</span>,
             <span class="dt">minpos =</span> -<span class="dv">2</span>)

<span class="kw">addPosLimit</span>( <span class="dt">portfolio =</span> portfolio.st, <span class="co"># add position limit rules</span>
             <span class="dt">symbol =</span> <span class="st">'symb2'</span>,
             <span class="dt">timestamp =</span> initDate,
             <span class="dt">maxpos =</span> <span class="dv">2</span>,
             <span class="dt">longlevels =</span> <span class="dv">1</span>,
             <span class="dt">minpos =</span> -<span class="dv">2</span>)

stratBBands &lt;-<span class="st"> </span><span class="kw">strategy</span>(<span class="st">&quot;bbands&quot;</span>) <span class="co"># strategy object init</span>

<span class="co"># Indicator</span>
stratBBands &lt;-<span class="st"> </span><span class="kw">add.indicator</span>(
  <span class="dt">strategy =</span> stratBBands,
  <span class="dt">name =</span> <span class="st">&quot;BBands&quot;</span>,
  <span class="dt">arguments =</span> <span class="kw">list</span>(
    <span class="dt">HLC =</span> <span class="kw">quote</span>(<span class="kw">HLC</span>(mktdata)),
    <span class="dt">n =</span> N,
    <span class="dt">sd =</span> SD,
    <span class="dt">maType =</span> <span class="st">&quot;SMA&quot;</span>),
  <span class="dt">label =</span> <span class="st">&quot;BBands&quot;</span>)

<span class="co"># #Indi Debug</span>
<span class="co"># summary(stratBBands)</span>
<span class="co"># start_t &lt;- Sys.time()</span>
<span class="co"># applyIndicators( strategy = stratBBands, mktdata = Ratio) # end_t&lt;-Sys.time() # print(&quot;strat execution time:&quot;) # print(end_t-start_t)</span>

<span class="co"># Add signals:</span>
stratBBands &lt;-<span class="st"> </span><span class="kw">add.signal</span>(
  <span class="dt">strategy =</span> stratBBands,
  <span class="dt">name =</span> <span class="st">&quot;sigCrossover&quot;</span>,
  <span class="dt">arguments =</span> <span class="kw">list</span>(
    <span class="dt">columns =</span> <span class="kw">c</span>(<span class="st">&quot;Close&quot;</span>,<span class="st">&quot;up.BBands&quot;</span>),
    <span class="dt">relationship =</span> <span class="st">&quot;gt&quot;</span>),
  <span class="dt">label =</span> <span class="st">&quot;Cl.gt.UpperBand&quot;</span>)

stratBBands &lt;-<span class="st"> </span><span class="kw">add.signal</span>(
  <span class="dt">strategy =</span> stratBBands,
  <span class="dt">name =</span> <span class="st">&quot;sigCrossover&quot;</span>,
  <span class="dt">arguments =</span> <span class="kw">list</span>(
    <span class="dt">columns =</span> <span class="kw">c</span>(<span class="st">&quot;Close&quot;</span>,<span class="st">&quot;dn.BBands&quot;</span>),
    <span class="dt">relationship =</span> <span class="st">&quot;lt&quot;</span>),
  <span class="dt">label =</span> <span class="st">&quot;Cl.lt.LowerBand&quot;</span>)

stratBBands &lt;-<span class="st"> </span><span class="kw">add.signal</span>(
  <span class="dt">strategy =</span> stratBBands,
  <span class="dt">name =</span> <span class="st">&quot;sigCrossover&quot;</span>,
  <span class="dt">arguments =</span> <span class="kw">list</span>(
    <span class="dt">columns =</span> <span class="kw">c</span>(<span class="st">&quot;High&quot;</span>,<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;mavg.BBands&quot;</span>),
    <span class="dt">relationship =</span> <span class="st">&quot;op&quot;</span>),
  <span class="dt">label =</span> <span class="st">&quot;Cross.Mid&quot;</span>)

<span class="co"># #Signal Debug</span>
<span class="co"># summary(stratBBands)</span>
<span class="co"># start_t &lt;- Sys.time()</span>
<span class="co"># applySignals(strategy = stratBBands, mktdata = applyIndicators(strategy = stratBBands, mktdata = Ratio)) # end_t&lt;-Sys.time() # print(&quot;strat execution time:&quot;) # print(end_t-start_t)</span>

<span class="co"># Rules -----</span>

<span class="co">#Entry</span>

stratBBands &lt;-<span class="st"> </span><span class="kw">add.rule</span> (
  <span class="dt">strategy =</span> stratBBands,
  <span class="dt">name =</span> <span class="st">&quot;ruleSignal&quot;</span>,
  <span class="dt">arguments =</span> <span class="kw">list</span>(
    <span class="dt">sigcol =</span> <span class="st">&quot;Cl.gt.UpperBand&quot;</span>,
    <span class="dt">sigval =</span> <span class="ot">TRUE</span>,
    <span class="dt">orderqty =</span> -<span class="dv">1</span>,
    <span class="dt">ordertype =</span> <span class="st">&quot;market&quot;</span>,
    <span class="dt">orderside =</span> <span class="st">&quot;short&quot;</span>,
    <span class="dt">symbol =</span> <span class="st">&quot;symb1&quot;</span>,
    <span class="dt">replace =</span> <span class="ot">TRUE</span>,
    <span class="dt">osFUN =</span> osMaxPos),
  <span class="dt">type =</span> <span class="st">&quot;enter&quot;</span>,
  <span class="dt">label =</span> <span class="st">&quot;ShortSpread_symb1&quot;</span>)

stratBBands &lt;-<span class="st"> </span><span class="kw">add.rule</span> (
  <span class="dt">strategy =</span> stratBBands,
  <span class="dt">name =</span> <span class="st">&quot;ruleSignal&quot;</span>,
  <span class="dt">arguments =</span> <span class="kw">list</span>(
    <span class="dt">sigcol =</span> <span class="st">&quot;Cl.gt.UpperBand&quot;</span>,
    <span class="dt">sigval =</span> <span class="ot">TRUE</span>,
    <span class="dt">orderqty =</span> <span class="dv">1</span>,
    <span class="dt">ordertype =</span> <span class="st">&quot;market&quot;</span>,
    <span class="dt">orderside =</span> <span class="st">&quot;long&quot;</span>,
    <span class="dt">symbol =</span> <span class="st">&quot;symb2&quot;</span>,
    <span class="dt">replace =</span> <span class="ot">TRUE</span>,
    <span class="dt">osFUN =</span> osMaxPos),
  <span class="dt">type =</span> <span class="st">&quot;enter&quot;</span>,
  <span class="dt">label =</span> <span class="st">&quot;ShortSpread_symb2&quot;</span>)

stratBBands &lt;-<span class="st"> </span><span class="kw">add.rule</span> (
  <span class="dt">strategy =</span> stratBBands,
  <span class="dt">name =</span> <span class="st">&quot;ruleSignal&quot;</span>,
  <span class="dt">arguments =</span> <span class="kw">list</span>(
    <span class="dt">sigcol =</span> <span class="st">&quot;Cl.lt.LowerBand&quot;</span>,
    <span class="dt">sigval =</span> <span class="ot">TRUE</span>,
    <span class="dt">orderqty =</span> <span class="dv">1</span>,
    <span class="dt">ordertype =</span> <span class="st">&quot;market&quot;</span>,
    <span class="dt">orderside =</span> <span class="st">&quot;long&quot;</span>
    <span class="dt">symbol =</span> <span class="st">&quot;symb1&quot;</span>,
    <span class="dt">replace =</span> <span class="ot">TRUE</span>,
    <span class="dt">osFUN =</span> osMaxPos),
  <span class="dt">type =</span> <span class="st">&quot;enter&quot;</span>,
  <span class="dt">label =</span> <span class="st">&quot;LongSpread_symb1&quot;</span>)

stratBBands &lt;-<span class="st"> </span><span class="kw">add.rule</span> (
  <span class="dt">strategy =</span> stratBBands,
  <span class="dt">name =</span> <span class="st">&quot;ruleSignal&quot;</span>,
  <span class="dt">arguments =</span> <span class="kw">list</span>(
    <span class="dt">sigcol =</span> <span class="st">&quot;Cl.lt.LowerBand&quot;</span>,
    <span class="dt">sigval =</span> <span class="ot">TRUE</span>,
    <span class="dt">orderqty =</span> -<span class="dv">1</span>,
    <span class="dt">ordertype =</span> <span class="st">&quot;market&quot;</span>,
    <span class="dt">orderside =</span> <span class="st">&quot;short&quot;</span>,
    <span class="dt">symbol =</span> <span class="st">&quot;symb2&quot;</span>,
    <span class="dt">replace =</span> <span class="ot">TRUE</span>,
    <span class="dt">osFUN =</span> osMaxPos),
  <span class="dt">type =</span> <span class="st">&quot;enter&quot;</span>,
  <span class="dt">label =</span> <span class="st">&quot;LongSpread_symb2&quot;</span>)

<span class="co"># Exit</span>
stratBBands &lt;-<span class="st"> </span><span class="kw">add.rule</span>(
  <span class="dt">strategy =</span> stratBBands,
  <span class="dt">name =</span> <span class="st">&quot;ruleSignal&quot;</span>,
  <span class="dt">arguments =</span> <span class="kw">list</span>(
    <span class="dt">sigcol =</span> <span class="st">&quot;Cross.Mid&quot;</span>,
    <span class="dt">sigval =</span> <span class="ot">TRUE</span>,
    <span class="dt">orderqty =</span> <span class="st">&quot;all&quot;</span>,
    <span class="dt">ordertype =</span> <span class="st">&quot;market&quot;</span>,
    <span class="dt">TxnFees =</span> <span class="dv">0</span>,
    <span class="dt">replace =</span> <span class="ot">TRUE</span>),
  <span class="dt">type =</span> <span class="st">&quot;exit&quot;</span>,
  <span class="dt">label =</span> <span class="st">&quot;Exit&quot;</span>)


<span class="kw">summary</span>(stratBBands)

<span class="co"># Strategy Execution ----</span>
start_t&lt;-<span class="kw">Sys.time</span>()
out&lt;-<span class="kw">try</span>(<span class="kw">applyStrategy</span>(<span class="dt">strategy=</span>stratBBands ,
                       <span class="dt">portfolios=</span><span class="st">&quot;bbands&quot;</span>))
end_t&lt;-<span class="kw">Sys.time</span>()
<span class="kw">print</span>(<span class="st">&quot;strat execution time:&quot;</span>)
<span class="kw">print</span>(end_t-start_t)

<span class="co"># update portfolio</span>
start_t&lt;-<span class="kw">Sys.time</span>()
<span class="kw">updatePortf</span>(<span class="dt">Portfolio=</span><span class="st">'bbands'</span>,<span class="dt">Dates=</span><span class="kw">paste</span>(<span class="st">'::'</span>,<span class="kw">as.Date</span>(<span class="kw">Sys.time</span>()),<span class="dt">sep=</span><span class="st">''</span>))
end_t&lt;-<span class="kw">Sys.time</span>()
<span class="kw">print</span>(<span class="st">&quot;updatePortf execution time:&quot;</span>)
<span class="kw">print</span>(end_t-start_t)

<span class="co">#Chart</span>
<span class="kw">chart.Posn</span>(<span class="dt">Portfolio=</span><span class="st">'bbands'</span>,<span class="dt">Symbol=</span><span class="st">&quot;symb1&quot;</span>)
<span class="kw">plot</span>(<span class="kw">add_BBands</span>(<span class="dt">on=</span><span class="dv">1</span>,<span class="dt">sd=</span>SD,<span class="dt">n=</span>N))
<span class="kw">chart.Posn</span>(<span class="dt">Portfolio=</span><span class="st">'bbands'</span>,<span class="dt">Symbol=</span><span class="st">&quot;symb2&quot;</span>)
<span class="kw">plot</span>(<span class="kw">add_BBands</span>(<span class="dt">on=</span><span class="dv">1</span>,<span class="dt">sd=</span>SD,<span class="dt">n=</span>N))
<span class="kw">chart.Posn</span>(<span class="dt">Portfolio=</span><span class="st">'bbands'</span>,<span class="dt">Symbol=</span><span class="st">&quot;symb1.symb2&quot;</span>)
<span class="kw">plot</span>(<span class="kw">add_BBands</span>(<span class="dt">on=</span><span class="dv">1</span>,<span class="dt">sd=</span>SD,<span class="dt">n=</span>N))

<span class="co">#Stats</span>
book &lt;-<span class="st"> </span><span class="kw">getOrderBook</span>(<span class="st">&quot;bbands&quot;</span>)
stats &lt;-<span class="st"> </span><span class="kw">tradeStats</span>(<span class="st">&quot;bbands&quot;</span>)
rets &lt;-<span class="st"> </span><span class="kw">PortfReturns</span>(<span class="st">&quot;bbands&quot;</span>)
port &lt;-<span class="st"> </span><span class="kw">getPortfolio</span>(<span class="st">&quot;bbands&quot;</span>)</code></pre>
<ul>
<li>Never uses retina figures</li>
<li>Has a smaller default figure size</li>
<li>Uses a custom CSS stylesheet instead of the default Twitter Bootstrap style</li>
</ul>
<div id="vignette-info" class="section level2">
<h2>Vignette Info</h2>
<p>Note the various macros within the <code>vignette</code> setion of the metadata block above. These are required in order to instruct R how to build the vignette. Note that you should change the <code>title</code> field and the <code>\VignetteIndexEntry</code> to match the title of your vignette.</p>
</div>
<div id="styles" class="section level2">
<h2>Styles</h2>
<p>The <code>html_vignette</code> template includes a basic CSS theme. To override this theme you can specify your own CSS in the document metadata as follows:</p>
<pre><code>output: 
  rmarkdown::html_vignette:
    css: mystyles.css</code></pre>
</div>
<div id="figures" class="section level2">
<h2>Figures</h2>
<p>The figure sizes have been customised so that you can easily put two images side-by-side.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="dv">1</span>:<span class="dv">10</span>)
<span class="kw">plot</span>(<span class="dv">10</span>:<span class="dv">1</span>)</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAC+lBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB1fEeTAAAA/nRSTlMAAQIDBAUGBwgJCgsMDQ4PEBESExQVFhcYGRobHB0eHyAhIiMkJSYnKCkqKywtLi8wMTIzNDU2Nzg5Ojs8PT4/QEFCQ0RFRkdISUpLTE5PUFFSU1RVVldYWVpbXF1eX2BhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ent8fX5/gIGCg4SFhoeIiYqLjI2Oj5CRkpOVlpeYmZqbnJ2en6ChoqOkpaanqKmqq6ytrq+wsbKztLW2t7i5uru8vb6/wMHCw8TFxsfIycrLzM3Oz9DR0tPU1dbX2Nna29zd3t/g4eLj5OXm5+jp6uvs7e7v8PHy8/T19vf4+fr7/P3+/2qHAEMAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAtESURBVHic7d15XNRWAgfwNyBQDm+0Kh7IaqGuN1rxqhfiUS12qxV1tVrEs2W3rWt3tcVaUVdtq9stKq4H3tIFW6u2dNXVWlFBuapo0RULqGC1UgSUQfL5bBJQ0cnkZULeZIDf94+8IXmT9z6/z0zmDfOSEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA1UrkpUQbdybpjFDkuesTUGqor017JenG2V8P+fv6FnXSJ6Dv++nTrkJuGcF2xHnJMQNJRUBS/vSpWHwbYOWAnt+9p0LBeGu2a7Gtk8Qi7rCVA2ow9qGiudZs12KRwWIRtUK3t1j+bH3aVWj0QQO/dDnnjYDM+PKb3k0DklYRBGSGw9tHM+KCDAiICgFRICAKBCRyey9m76IGUlsQkKDZlY3+g/6Z1VZiEwIS/CtUWI7fK7EJAQkKXYSlPedmugkB8ZyLykvud6bbEJDgspewbJxrb7oJAQmCjzQnpOG++RKbEJDAsDQvevf1NRIvIARU4dlhI1pIbkBAFAiIopYG1GZw5zrKajILqFlrA7HzbGpus64BNT94JeZUxmBFdRkF1OwYxx3t/RPHxTWRrqBrQIfDHAjxz/ZQUpdRQP8+0dL967JNDTwT9khX0DOgvsfFYt4KJZUZBVT0MiF+XGNCxhRWXt31u4eM85i0q8iMtWIxiVNSmVFAd8YTMkgIaGx+5dXO/g/dncOkXUUmbhOL8SeUVGYU0LqMIf0SCzfWb5u8WbqCnm8x98vCgdGwb6ySyowCco3ML1rfPo3jDjaUrqDrQTo4+40OI47EGpTUZToOMrR91twmfcdBflviY6faKapaSweKyiEgCgREURsCcp7/3akdfiqfXAsCcjgZ06f9tJwgdc+uBQG9JQ6cW15xVfXsWhDQ4UFikfiqqmfXgoASeogFt0TVs2tBQOtChKUh3VvVs2tBQF5ZAwlxi9iu7tkWB9RhbXphWVH65z7q2nvImh/zgy+dPZC3pb66J1saUEBJbFCPDj1f21k8RF2DFaw6ULT37t9Y7XMtDSh1TcWDsBS1TYpq7Ej6QUDFg+6lVWq3xgZ0eUHFgxn/q1K7LAPyHvNSc812ZmlArxuXd3Wzc+kUVjxVtl6vzUPtF/xsTJtgZju7gFx2ZUXuuLVIq91Z/Ck26qiR4zjjf0fK1gp6sKP9wrwJnUPvTZSuwC6g1RucCWl+TNH/UxVQMQ5ybOPdxpFSJzOckBwhm7Dz0hWYBVT3ppNQdD+j0f4YDRSNwwgpFXY99EHl1T0fnc9Xyupnn06pYuGs6DcdBRgFdHIlv+tx/IN3Myuvduj28Iy+AlavII9ssWh9V6P9MQpoQPGnXcZd6uE4On+WdAV2x6DDrwjLZeEa7c7SgHwek63XLbaQP5ZzSebOm2MXUIdrEQGBB89KTFhVxdKA4rlHKDXtPbzb1TW7leE4qNHCL7bNpH2KKGbxWyyE66hFuzV2JE0cihGQvBAzM34sU4MD0oZmAdWZG3/9ZKjC+XQqVPuAtse94PpC3C6N9mZKRUCc2JtdVRuqahVQn3hh9rf98QHa7M6UioB8xLl9HlX7n6tWAYX/TSyWxWqzO1PV/S32yZ/FIuKcNrszVd0DGrdbLHYyu9JFdQ/IPiHMmTiFJUqdh6KJ6h4QaR5z6/QvMdInomiB1ZdVGg0His5eLprtyxS7L6vyau5IGl9WKfT+surzxtz+WnRAKbZfVhM9zW1RGZBhTfbqpUmHVP7OrgajT7GK4zg30tyxXGVAU/fXI8TuQzPT91lgFFA+7ViuMqDkLsLSPlf1XASLMQrI63TSc3zBPfX68bt1u0KZ1CnYdPn1xIIbUcX+KcdqoOi46rdJpgEZGj70m7pX0MXnxCKH3cDwaexG0iNubnJ9OqDHVL7F5kcKZ1hMPaC2U5Zj+FWjxeELmgfk9J+EkEm7Mr1Ud8piLL+L2c/f29LcNrXjIEPgqs+mO6vtkQrV/ssqawiIAgFR2HZAhmkpd65FtWLdGTm2HdB7Z3oZ6oVlSl6ezkpsOqDGP4vfSsM+YtwZOTYd0OgvxaKvVrPF1LDpgALLf+3qh4DMaJYpDgnnrWLcGTk2HRAJP9KO1JlzVZP5JCrZdkD272Rn3d6v7kQvjdh2QLy67Ga2KGLzAekNAVHYVkA+b4VP03PYLIFRQHU+unE/Tji4BlvyT/u/3Pz7nKjcgUx6pBajgJbdDvJdm+dhWUA9UoXP8/7nn2HSJZUYBZQ3i/8qvifasoDKz98mMWOYdEklRgE9EE75bV3c56mA/B7/XDbT9En7y89Bux3HpEsqMQro4mphuTjN1dwrSOruUGtniEVsIJMuqcQooFlc9GRCnklIjLIgoO5ptecYZAhJOcUXjaJKLAiIhOaufHN7Ti8mPVKL9TjIpbP0eukbsHnPXfJ67RgHUdn4HeoeQ0AU+gbkbFPHY0l6BhSYfiM31XoTWdTRMaBR6QMJGX6J2Wko2tAxoPTnhQd+J/XpgFL6BeR+U3xg4FhOA686/QJqdEt8YMc56dMDhXR8i53uIzwYekSfDiilY0ADsoMcnaZd89WnA0rpFRAXFRKy4sLdgnNLQyqbeWArzZ6vqFW+iqZW+WYbtUqs2CNOp4Didq+TsrPkPE1OPrXK7evUKvcu02pcNIo92qDuCqestL5KrTKBfkHEz81cUaUS+jun/h3qTnSAgCgQEAUCokBAFAiIAgFRICCK5unUKmMjqVXWTKFWSZS45+yTXHOoO9FDI2oNh3rUKnXpVzBTcMqi9c5qBAAAAAAAAKi+DDMulOYupZ3/5JUvfwG+F+ONmfI3NHSJ+LUoRu7mLSfKW5icUZo8lNIbq5rOrfGffXuxfCXH0+YvmSLoVrxq+LIHsjfFXJ8RFBj/vdnNdaaXtzDK+P7wz0o6yHfHqlKi+UXQDflKK5PlA4oR5rDv3CJXJd+fkFacuWsQhRRy5S0cXc4v9q6V745VnZrML3zvy9YZUeAtG5D93a78sr3sO6O4HyHuXGszW5t07Ci24Gjsxi+D6P/jtC5DhOypGi3y/mhyXasneHBjU0pz3pe9tuv6xAG99h2VuVm42EIbTrj1RM9CuT1ZX+vdebKvj0ObTS/89QRv7tJrnSfdXCjXSDv+TVQmd5QSW/DmhKtd/V7Pk/ZNOC0ujjZ7TSbB/AtulIDacsJdQydmy1QxpG5q7L75J5nbqYsttBInB/YskuuPlTU8fa6vfI295edSJZqv4SJO6etSIrMTT64B3xbnab6GGFCdEuGao+Nt6RgUdYZ2w5mW5Zev9JSpkvgyvwiVuwNjE85LeKW5m69R/ho9/AG/2BVB6ZIVuZRsDRbQ6sl/zI/Lfyfgg3uyVyjfn/zqmIRvqS0MKwr2XXSvivdL1VInhddhlg+IzL5aet7cnQPLNdySX7hH7noXFS1MuVSaZlMjaQAAAAAAAAAAAAAAAAAA0JaPyW/UpmtqNQREgYAoEBCFEAc3KK4kS5gb+1LC/TtfjOTXGN7NMv4YbCAvlg4iZMGNpnr3UkdiQClTem4oaUCGl20fM3pjIb9mZkrQkCXGNwlZllmvy/0AvTupJzGgWcKsRB/ygzhR7h/8mh+F+9ktzyDEMWlL8sc6d1FfYkDC5ar5gIrFSb29+TVGcZKakf+rw700275EI2tiQMJcOX5RKAbUi19T2Em8Tzn/16CyX5rp20OdVQ7o2KO32A/CpMLwTwhplPXXE1/LzKav+SoHNKxse+CoDXn8mqDc4MEfc38ghujj9t7F1BmzNVnlgPiP+ZKCnQOEj/nQbGNaECFTC9sR8naBFe8KDQAAAAAAAAAAAAAAAADwf56ZqIKFZjH7AAAAAElFTkSuQmCC" /> <img src="data:image/png;base64,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" /></p>
<p>You can enable figure captions by <code>fig_caption: yes</code> in YAML:</p>
<pre><code>output:
  rmarkdown::html_vignette:
    fig_caption: yes</code></pre>
<p>Then you can use the chunk option <code>fig.cap = &quot;Your figure caption.&quot;</code> in <strong>knitr</strong>.</p>
</div>
<div id="more-examples" class="section level2">
<h2>More Examples</h2>
<p>You can write math expressions, e.g. <span class="math">\(Y = X\beta + \epsilon\)</span>, footnotes<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>, and tables, e.g. using <code>knitr::kable()</code>.</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">mpg</th>
<th align="right">cyl</th>
<th align="right">disp</th>
<th align="right">hp</th>
<th align="right">drat</th>
<th align="right">wt</th>
<th align="right">qsec</th>
<th align="right">vs</th>
<th align="right">am</th>
<th align="right">gear</th>
<th align="right">carb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Mazda RX4</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160.0</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.620</td>
<td align="right">16.46</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">Mazda RX4 Wag</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160.0</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.875</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">Datsun 710</td>
<td align="right">22.8</td>
<td align="right">4</td>
<td align="right">108.0</td>
<td align="right">93</td>
<td align="right">3.85</td>
<td align="right">2.320</td>
<td align="right">18.61</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Hornet 4 Drive</td>
<td align="right">21.4</td>
<td align="right">6</td>
<td align="right">258.0</td>
<td align="right">110</td>
<td align="right">3.08</td>
<td align="right">3.215</td>
<td align="right">19.44</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">Hornet Sportabout</td>
<td align="right">18.7</td>
<td align="right">8</td>
<td align="right">360.0</td>
<td align="right">175</td>
<td align="right">3.15</td>
<td align="right">3.440</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">Valiant</td>
<td align="right">18.1</td>
<td align="right">6</td>
<td align="right">225.0</td>
<td align="right">105</td>
<td align="right">2.76</td>
<td align="right">3.460</td>
<td align="right">20.22</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">Duster 360</td>
<td align="right">14.3</td>
<td align="right">8</td>
<td align="right">360.0</td>
<td align="right">245</td>
<td align="right">3.21</td>
<td align="right">3.570</td>
<td align="right">15.84</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">Merc 240D</td>
<td align="right">24.4</td>
<td align="right">4</td>
<td align="right">146.7</td>
<td align="right">62</td>
<td align="right">3.69</td>
<td align="right">3.190</td>
<td align="right">20.00</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">Merc 230</td>
<td align="right">22.8</td>
<td align="right">4</td>
<td align="right">140.8</td>
<td align="right">95</td>
<td align="right">3.92</td>
<td align="right">3.150</td>
<td align="right">22.90</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">Merc 280</td>
<td align="right">19.2</td>
<td align="right">6</td>
<td align="right">167.6</td>
<td align="right">123</td>
<td align="right">3.92</td>
<td align="right">3.440</td>
<td align="right">18.30</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
</tbody>
</table>
<p>Also a quote using <code>&gt;</code>:</p>
<blockquote>
<p>“He who gives up [code] safety for [code] speed deserves neither.” (<a href="https://twitter.com/hadleywickham/status/504368538874703872">via</a>)</p>
</blockquote>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>A footnote here.<a href="#fnref1">↩</a></p></li>
</ol>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
